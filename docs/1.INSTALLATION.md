# üìñ Installation Guide

This guide covers all methods of installing and deploying MyAstroBoard.

## Prerequisites

### Required
- **Docker**
- **Docker Compose**
- **Internet connection** (for downloading images and target catalogues)

## Installation

### Option 1: Using Published Docker Image (Recommended for Users)

1. Create and move in the directory you want install this image
```bash
# Example
mkdir /opt/myastroboard
cd /opt/myastroboard
```

2. **Download the docker-compose file**:
```bash
curl -o docker-compose.yml https://raw.githubusercontent.com/WorldOfGZ/myastroboard/main/docker-compose.yml
```

3. **Start the application**:
```bash
docker compose up -d
```

4. **Access the dashboard**:
Open your browser and navigate to `http://localhost:5000`

The system will automatically:
- Start the web dashboard
- Initialize the scheduler
- Run uptonight every 2 hours for each selected target
- Store outputs in `./uptonight_outputs/`

5. **Update to latest version - Not necessary at first install**:
```bash
docker compose pull
docker compose up -d
```

### Option 2: Build from Source (For Developers)

1. **Clone the repository**:
```bash
git clone https://github.com/WorldOfGZ/myastroboard.git
cd myastroboard
```

2. **Edit docker-compose.yml file (if necessary)**:
```bash
nano docker compose.yml
```

3. **Build the application**:
```bash
docker compose build
```

4. **Start the application**:
```bash
docker compose up -d
```

5. **Access the dashboard**:
Open your browser and navigate to `http://localhost:5000`

The system will automatically:
- Start the web dashboard
- Initialize the scheduler
- Run uptonight every 2 hours for each selected target
- Store outputs in `./uptonight_outputs/`

6. **Debug & venv**
```bash
# Create venv
python -m venv venv

# Activate venv
# Windows
.\venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# Install requirements
pip install -r requirements.txt

# Install dev tools
pip install black ruff pytest pytest-cov
```

```bash
# Debug Launch
docker compose -f docker-compose-dev.yml -f docker-compose.debug.yml up --build
```

7. **Tests**

```bash
# Execute tests with covering
pytest --cov=backend tests/

# Execute specific test
pytest tests/test_target_loader.py -v
```

## Advanced configuration

### Security Configuration (IMPORTANT!)

For production deployments, you **must** configure a secure SECRET_KEY for session management:

1. **Generate a secure SECRET_KEY**:

   Choose one of these methods:
   
   ```bash
   # Method 1 - Python (recommended)
   python3 -c "import secrets; print(secrets.token_hex(32))"
   ```
   
   ```bash
   # Method 2 - OpenSSL
   openssl rand -hex 32
   ```
   
   Or use an online generator: [https://randomkeygen.com/](https://randomkeygen.com/) (use "CodeIgniter Encryption Keys")

2. **Set the SECRET_KEY**:

   Option A - Using .env file (recommended):
   ```bash
   # Copy the example file
   cp .env.example .env
   
   # Edit .env and set SECRET_KEY
   nano .env
   ```
   
   Option B - Directly in docker-compose.yml:
   ```yaml
   environment:
     - SECRET_KEY=your-generated-secret-key-here
   ```

**‚ö†Ô∏è WARNING**: If SECRET_KEY is not set, sessions will be invalidated on every container restart, forcing all users to log in again.

### Default Credentials

On first run, a default admin account is created:
- **Username**: `admin`
- **Password**: `admin`

**üîí IMPORTANT**: Change the default password immediately after first login! The application will display a warning banner until you do.

### Environment Variables

Key configuration options (set in `docker-compose.yml`):

```bash
# Security
- SECRET_KEY=your-secret-key-here-replace-with-random-64-character-hex-string

# Scheduling
- SCHEDULE_INTERVAL=7200  # Run UpTonight every 2 hours (seconds)

# Directories (defaults work for Docker)
# App
- DATA_DIR=/app/data
- OUTPUT_DIR=/app/uptonight_outputs
- CONFIG_DIR=/app/uptonight_configs

# Docker-in-Docker paths
- HOST_OUTPUT_DIR=${PWD}/uptonight_outputs
- HOST_CONFIG_DIR=${PWD}/uptonight_configs
```

See `.env.example` for full documentation.

### Data Persistence

All configuration and outputs are stored in Docker volumes:
- `./data/` - Configuration files (survives container rebuilds)
- `./uptonight_outputs/` - Generated plots and reports **organized by catalogue**:
  - `./uptonight_outputs/Messier/` - Messier catalogue outputs
  - `./uptonight_outputs/Herschel400/` - Herschel400 catalogue outputs
  - `./uptonight_outputs/{catalogue}/` - Each catalogue in its own subdirectory
- `./uptonight_configs/` - Generated uptonight configurations

**Important**: These directories persist across Docker container rebuilds, ensuring your settings and data are never lost.

## Getting started

When everything is installed, you can configure interface on web UI - Consult [Quick Start](2.QUICKSTART.md)