services:
  myastroboard:
    # Use local build instead of published image for development
    build: .
    
    # Mount source code directories for live editing
    volumes:
      - ./static:/app/static
      - ./templates:/app/templates
      - ./backend:/app/backend
    
    environment:
      FLASK_DEBUG: 1
      FLASK_ENV: development
      SCHEDULE_INTERVAL: 300
      # Keep sessions stable across debug reloads/restarts
      SECRET_KEY: ${SECRET_KEY:-dev-insecure-secret-change-me-0123456789abcdef0123456789abcdef}
      # Enable Flask auto-reload for Python files
      FLASK_RUN_RELOAD: 1
      # Disable template caching for immediate updates
      TEMPLATES_AUTO_RELOAD: 1
      # Log level for more verbose output during development
      LOG_LEVEL: DEBUG
    
    command: ["python", "backend/app.py"]

# Usage: docker compose -f docker-compose-dev.yml -f docker-compose.debug.yml up --build
# This enables live editing of:
# - Static files (CSS, JS): ./static -> /app/static  
# - HTML templates: ./templates -> /app/templates
# - Python backend: ./backend -> /app/backend